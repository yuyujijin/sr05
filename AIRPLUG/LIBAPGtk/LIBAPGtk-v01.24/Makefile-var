# license type: free of charge license for academic and research purpose
# see license.txt
# author: Bertrand Ducourthial

# Configuration file for layer 3 Makefile adapted to not compiled libraries.
#  - distributed in the skeleton distribution (the nest)
#  - not distributed in the binary distribution (or as binary package)
#    (Application that does not require compilation)
# This file is NOT dedicated to applications. It is adapted to LIBAPGtk,
# LIBAPGpy... (LIB and SOURCES variables differ)


### APPLICATION DEPENDENT VARIABLES ############################################

#-- Setting the type of contribution this directory provides ------------------#
#   Makefile for a library
TYPE=lib

# Determining the file extension (language) from the directory name -----------#
# NB: Assuming the directory is of the form WHA, WHAtk, WHApy, etc.
#     If no lower cases are found, the default is tk.
# NB: ll is the extension in lower case, LL in uppercase.
L = $(shell pwd | rev | cut -d'/' -f 2 | rev | sed s/^[[:upper:]]*//)
ll = $(shell if [ "x$(L)" = "x" ] ; then echo "tk" ; else echo $(L) ; fi )


# Determining the sources files -----------------------------------------------#
# NB: Assuming the files of libraries are of the form
#     - rc-$(OUTPUT).ll such as rc-libapg.tk for a resource file with the
#       default parameters values.
#     - libapg*.ll providing such files are not symbolic links.
#       Indeed, symbolic links are library files installed by the applications.
# NB: Adding a new library does not require to adapt the variables values below
#     providing the file has been named according to the rules above.

# RC is either empty or equal to rc-$(OUTPUT).$(ll) if it exists
RC = $(wildcard rc-$(OUTPUT).$(ll))

# LIB contains all files libapg-???.$(ll) or libapg_???.$(ll) which are not
# symbolic links.
# NB: quotes to protect the patern given to find not necessary (maxdepth = 1)
LIB = $(shell find libapg.$(ll) libapg-???.$(ll) libapg_???.$(ll) -maxdepth 1 -type f 2> /dev/null)

# SOURCES stands for all sources files belonging to the library.
# NB : wildcard does the immediat expansion.
SOURCES = $(RC) $(LIB)


#-- FILES FOR APPLICATION PACKAGING--------------------------------------------#

# List of all files for the public archive
# NB: any file in the bin/doc/icons or input subdirectory of the application
#     will be installed (with symlink) in the bin/doc/icons or input/$(OUTPUT)
#     of the distribution.
# NB: if one of these subdirectories is listed here while they do not exist,
#     it is ignored silently.
# NB: Add both directory_name and directory_name/* (such as bin and bin/*)
TGZ_PUB = \
	Makefile Makefile-var Makefile-bin \
	license.txt \
	README.pub \
	$(SOURCES) \
	bin \
	bin/* \
	doc \
	doc/* \
	input \
	input/* \
	icons \
	icons/*

# List of all files for the devel archive
TGZ_DEV = $(TGZ_PUB) \
	README.dev \
	tgz-history \
	icon/*obj

# List of all files for the distribution skeleton archive
TGZ_SKL = $(TGZ_PUB)

# List of all files for the binary distribution
TGZ_BIN =

